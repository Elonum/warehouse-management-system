База данных для складского учёта с поддержкой:
- остатков товаров
- истории движений
- себестоимости
- нескольких складов
- маркетплейсов

## Описание SQL файлов

### `schema.sql`
Основная схема базы данных.

Содержит:
- товары (Products)
- склады (Warehouses)
- поставки от поставщиков
- отгрузки на маркетплейсы
- инвентаризации
- снапшоты остатков
- историю себестоимости

Используется для первоначального развёртывания БД.

---

### `vw_stock_movements.sql`
Представление всех движений товара.

Объединяет в единый журнал:
- приход от поставщиков
- расход на маркетплейсы
- корректировки инвентаризации

Используется как **единый источник движений**.

---

### `vw_stock_movements_since_snapshot.sql`
Представление движений **после последнего снапшота**.

Используется для:
- быстрого расчёта актуальных остатков
- минимизации объёма данных при расчётах

Работает совместно с `StockSnapshots`.

---

### `vw_current_stock.sql`
Основное представление актуальных остатков.

Логика:
- берёт последний снапшот
- прибавляет движения после него

Используется:
- в API
- в админке
- для аналитики

---

### `vw_stock_with_cost.sql`
Остатки с учётом себестоимости.

Добавляет:
- актуальную себестоимость товара
- общую стоимость остатков

Используется для:
- финансовой аналитики
- оценки складских запасов

---

### `vw_warehouse_stock_value.sql`
Суммарная стоимость остатков по складам.

Используется для:
- дашбордов
- отчётов
- оценки капитала в запасах

---

## Принцип работы остатков

1. Остатки фиксируются раз в месяц в `StockSnapshots`
2. Все движения хранятся отдельно
3. Актуальные остатки считаются как:
Snapshot + Movements